{"version":3,"sources":["webpack:///webpack/bootstrap 5e8ab524c9d1c7643f76","webpack:///./classes/server/Client.js","webpack:///./classes/server/DatabaseManager.js","webpack:///./classes/server/Level.js","webpack:///external \"express\"","webpack:///external \"http\"","webpack:///external \"random-token\"","webpack:///external \"ws\"","webpack:///./app.js","webpack:///./classes/shared/PlayerCharacter.js","webpack:///external \"fs\"","webpack:///./classes/GameSettings.js","webpack:///./classes/shared/GameObject.js","webpack:///./classes/shared/Sprite.js","webpack:///./classes/MessageTypes.js","webpack:///./classes/shared/Character.js"],"names":["Client","info","socket","token","authenticated","ipAddress","upgradeReq","headers","connection","remoteAddress","playerCharacter","module","exports","DatabaseManager","playerName","DbManager","fs","require","Level","levelId","start","tx","ty","tileMap","sprites","id","loadFromJSONFile","Error","prototype","filename","levelData","JSON","parse","readFileSync","world","levels","clients","log","console","authenticate","authString","split","user","passHash","toLowerCase","app","use","static","createServer","listen","initiateClient","clientToken","client","on","clientMessage","bind","sendPackage","Who","type","attributes","MoveTo","stringify","send","Object","assign","incoming","message","who","getPlayer","Authentication","success","errorMessage","Port","level","pc","KeyPressed","handleKeyPressed","KeyReleased","handleKeyReleased","Cast","castSpell","action","newDirection","x","y","setPosition","position","player","canCast","spellId","fb","FireBall","gameServer","Server","perMessageDeflate","port","PlayerCharacter","characterName","startX","startY","name","strength","health","color","Math","round","TILE_SCALE","GameSettings","GameObject","Sprite","MessageTypes","Character"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;AC/DA,SAASA,MAAT,CAAgBC,IAAhB,EAAsB;AACpB,OAAKC,MAAL,GAAcD,KAAKC,MAAnB;AACA,OAAKC,KAAL,GAAaF,KAAKE,KAAlB;AACA,OAAKC,aAAL,GAAqBH,KAAKG,aAAL,IAAsB,KAA3C;AACA,OAAKC,SAAL,GAAiB,KAAKH,MAAL,CAAYI,UAAZ,CAAuBC,OAAvB,CAA+B,iBAA/B,KACI,KAAKL,MAAL,CAAYI,UAAZ,CAAuBE,UAAvB,CAAkCC,aADvD;AAEA,OAAKC,eAAL,GAAuBT,KAAKS,eAAL,IAAwB,IAA/C;AACD;;AAEDC,OAAOC,OAAP,GAAiBZ,MAAjB,C;;;;;;;;;;;;;;;ACVA;;;;;;;;IAEMa,e;;;;;;;8BACMC,U,EAAY;AACpB;AACA,aAAO,8BAAoB,OAApB,CAAP;AACD;;;;;;AAGH,IAAMC,YAAY,IAAIF,eAAJ,EAAlB;;kBAEeE,S;;;;;;;;;ACVf,IAAMC,KAAK,mBAAAC,CAAQ,EAAR,CAAX;;AAEA,SAASC,KAAT,CAAeC,OAAf,EAAwB;AACtB;AACA,OAAKC,KAAL,GAAa,EAAEC,IAAI,CAAC,CAAP,EAAUC,IAAI,CAAC,CAAf,EAAb;AACA,OAAKC,OAAL,GAAe,EAAf;AACA,OAAKC,OAAL,GAAe,EAAf;;AAEA;AACA,MAAIL,OAAJ,EAAa;AACX,SAAKM,EAAL,GAAUN,OAAV;AACA,SAAKO,gBAAL,qBAAwCP,OAAxC;AACD,GAHD,MAGO;AACL,UAAM,IAAIQ,KAAJ,CAAU,yBAAV,CAAN;AACD;AACF;;AAEDT,MAAMU,SAAN,CAAgBF,gBAAhB,GAAmC,SAASA,gBAAT,CAA0BG,QAA1B,EAAoC;AACrE,MAAMC,YAAYC,KAAKC,KAAL,CAAWhB,GAAGiB,YAAH,CAAgBJ,QAAhB,EAA0B,OAA1B,CAAX,CAAlB;AACA,OAAKT,KAAL,GAAaU,UAAUV,KAAvB;AACA,OAAKG,OAAL,GAAeO,UAAUP,OAAzB;AACA,OAAKC,OAAL,GAAeM,UAAUN,OAAzB;AACD,CALD;;AAOAb,OAAOC,OAAP,GAAiBM,KAAjB,C;;;;;;;ACzBA,oC;;;;;;ACAA,iC;;;;;;ACAA,yC;;;;;;ACAA,+B;;;;;;;;;ypBCAA;;;AAMA;;;AALA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;AACA;;;;AAEA;;;;AAWA;;;;;;AATA;;AAEA;AACA,IAAMgB,QAAQ;AACZC,UAAQ,EADI;AAEZC,WAAS;AAFG,CAAd;;AAKA;;;AAGA;AACA,IAAMC,MAAMC,QAAQD,GAApB,C,CAAyB;;AAEzB,IAAME,eAAe,SAASA,YAAT,CAAsBC,UAAtB,EAAkC;AAAE;AACvD;AADqD,0BAE5BA,WAAWC,KAAX,CAAiB,GAAjB,CAF4B;AAAA;AAAA,MAE9CC,IAF8C;AAAA,MAExCC,QAFwC;;AAIrD,MAAID,QAAQC,QAAR,IAAoBD,KAAKE,WAAL,OAAuB,OAA/C,EAAwD;AACtD,WAAO,IAAP;AACD;;AAED,SAAO,KAAP;AACD,CATD;;AAWA;AACA,IAAMC,MAAM,wBAAZ;AACAA,IAAIC,GAAJ,CAAQ,kBAAQC,MAAR,CAAe,QAAf,CAAR;AACA,eAAKC,YAAL,CAAkBH,GAAlB,EAAuBI,MAAvB,CAA8B,IAA9B,EAAoC;AAAA,SAAMZ,IAAI,cAAJ,CAAN;AAAA,CAApC;;AAEA;AACA,IAAMa,iBAAiB,SAAjBA,cAAiB,CAAChD,MAAD,EAAY;AACjC;AACA,MAAIiD,cAAc,2BAAY,EAAZ,CAAlB;AACA,SAAOjB,MAAME,OAAN,CAAce,WAArB,EAAkC;AAChCA,kBAAc,2BAAY,EAAZ,CAAd;AACD;AACD,MAAMC,SAAS,qBAAW;AACxBjD,WAAOgD,WADiB;AAExBjD,kBAFwB;AAGxBQ,qBAAiB;AAHO,GAAX,CAAf;AAKAwB,QAAME,OAAN,CAAce,WAAd,IAA6BC,MAA7B;;AAEA;AACAlD,SAAOmD,EAAP,CAAU,SAAV,EAAqBC,cAAcC,IAAd,CAAmBH,MAAnB,CAArB;AACA;AACA;;AAEAlD,SAAOmD,EAAP,CAAU,YAAV,EAAwB,UAACpD,IAAD,EAAU;AAChCoC,QAAIpC,IAAJ;AACD,GAFD;;AAIAuD,cAAYtD,MAAZ,EAAoB,uBAAauD,GAAjC;AACD,CAvBD;;AAyBA,IAAMD,cAAc,SAASA,WAAT,CAAqBtD,MAArB,EAA2D;AAAA,MAA9BwD,IAA8B,uEAAvB,IAAuB;AAAA,MAAjBC,UAAiB,uEAAJ,EAAI;;AAC7E,MAAIzD,WAAW,IAAf,EAAqB,MAAM,IAAIyB,KAAJ,CAAU,2BAAV,CAAN,CADwD,CACV;AACnE,MAAI+B,SAAS,IAAb,EAAmB,MAAM,IAAI/B,KAAJ,CAAU,iCAAV,CAAN;;AAEnB,MAAG+B,SAAS,uBAAaE,MAAzB,EAAiCtB,QAAQD,GAAR,CAAY,eAAeN,KAAK8B,SAAL,CAAeF,UAAf,CAA3B;AACjCzD,SAAO4D,IAAP,CAAY/B,KAAK8B,SAAL,CAAeE,OAAOC,MAAP,CAAc,EAAEN,UAAF,EAAd,EAAwBC,UAAxB,CAAf,CAAZ;AACD,CAND;;AAQA,IAAML,gBAAgB,SAASA,aAAT,GAAwC;AAAA,MAAjBW,QAAiB,uEAAN,IAAM;;AAC5D;;AAEA,MAAMC,UAAUnC,KAAKC,KAAL,CAAWiC,QAAX,CAAhB;;AAEA,UAAQC,QAAQR,IAAhB;AACE,SAAK,uBAAaD,GAAlB;AACE,UAAIlB,aAAa2B,QAAQC,GAArB,CAAJ,EAA+B;AAC7B,aAAKzD,eAAL,GAAuB,0BAAgB0D,SAAhB,CAA0B,OAA1B,CAAvB;AACAZ,oBACE,KAAKtD,MADP,EAEE,uBAAamE,cAFf,EAGE,EAAEC,SAAS,IAAX,EAAiBnE,OAAO,KAAKA,KAA7B,EAAoCO,iBAAiBqB,KAAK8B,SAAL,CAAe,KAAKnD,eAApB,CAArD,EAHF;AAKD,OAPD,MAOO;AACL8C,oBACE,KAAKtD,MADP,EAEE,uBAAamE,cAFf,EAGE,EAAEC,SAAS,KAAX,EAAkBC,cAAc,wBAAhC,EAHF;AAKD;AACD;AACF,SAAK,uBAAaC,IAAlB;AAAwB;AACtB;AACA,UAAMC,QAAQ,oBAAUP,QAAQ/C,OAAlB,CAAd;AACA,UAAMuD,KAAK,KAAKhE,eAAhB;AACAgE,SAAGrD,EAAH,GAAQoD,MAAMrD,KAAN,CAAYC,EAApB;AACAqD,SAAGpD,EAAH,GAAQmD,MAAMrD,KAAN,CAAYE,EAApB;;AAEA;AACA;AACAkC,kBACE,KAAKtD,MADP,EAEE,uBAAasE,IAFf,EAGE,EAAEF,SAAS,IAAX,EAAiBG,YAAjB,EAAwB/D,iBAAiBgE,EAAzC,EAHF;AAKA;AACF,SAAK,uBAAaC,UAAlB;AACEC,uBAAiB,IAAjB,EAAuBV,OAAvB;AACA;AACF,SAAK,uBAAaW,WAAlB;AACEC,wBAAkB,IAAlB,EAAwBZ,OAAxB;AACA;AACF,SAAK,uBAAaa,IAAlB;AACEC,gBAAU,IAAV,EAAgBd,OAAhB;AACA;AACF;AACE7B,UAAI,gCAAJ;AACA;AA3CJ;AA6CD,CAlDD;;AAoDA,IAAMuC,mBAAmB,SAASA,gBAAT,CAA0BxB,MAA1B,EAAkCc,OAAlC,EAA2C;AAClE,MAAMe,SAASf,QAAQe,MAAvB;AACA,MAAMP,KAAKtB,OAAO1C,eAAlB;AACA,MAAMwE,eAAe,EAAEC,GAAG,CAAL,EAAQC,GAAG,CAAX,EAArB;AACA,UAAQH,MAAR;AACE,SAAK,MAAL;AACEC,mBAAaC,CAAb,IAAiB,CAAjB;AACA;AACA;AACF,SAAK,OAAL;AACED,mBAAaC,CAAb,IAAiB,CAAjB;AACA;AACA;AACF,SAAK,IAAL;AACED,mBAAaE,CAAb,IAAiB,CAAjB;AACA;AACA;AACF,SAAK,MAAL;AACEF,mBAAaE,CAAb,IAAiB,CAAjB;AACA;AACA;AACF;AACE;AAlBJ;AAoBA;AACAF,eAAaC,CAAb,IAAkB,GAAlB;AACA;AACAD,eAAaE,CAAb,IAAkB,GAAlB;AACAV,KAAGW,WAAH,CAAe;AACbF,OAAGT,GAAGY,QAAH,CAAYH,CAAZ,GAAgBD,aAAaC,CADnB;AAEbC,OAAGV,GAAGY,QAAH,CAAYF,CAAZ,GAAgBF,aAAaE;AAFnB,GAAf;AAIA9C,UAAQD,GAAR,CAAYqC,GAAGY,QAAf;AACA9B,cACEJ,OAAOlD,MADT,EAEE,uBAAa0D,MAFf,EAGE;AACEuB,OAAGT,GAAGY,QAAH,CAAYH,CADjB;AAEEC,OAAGV,GAAGY,QAAH,CAAYF;AAFjB,GAHF;AAQA9C,UAAQD,GAAR,gBAAyB4C,MAAzB;AACD,CA1CD;AA2CA,IAAMH,oBAAoB,SAASA,iBAAT,CAA2B1B,MAA3B,EAAmCc,OAAnC,EAA4C;AACpE,MAAMe,SAASf,QAAQe,MAAvB;AACD,CAFD;;AAIA,IAAMD,YAAY,SAASA,SAAT,CAAmB5B,MAAnB,EAA2Bc,OAA3B,EAAoC;AACpD,MAAGd,OAAOmC,MAAP,CAAcC,OAAd,CAAsBtB,QAAQuB,OAA9B,CAAH,EAA2C;AACzC;AACA,QAAMC,KAAK,IAAIC,QAAJ,EAAX;AACD,GAHD,MAGO,CAEN;AACF,CAPD;;AASA;AACA,IAAMC,aAAa,IAAI,aAAUC,MAAd,CAAqB;AACtCC,qBAAmB,KADmB;AAEtCC,QAAM;AAFgC,CAArB,CAAnB;AAIAH,WAAWvC,EAAX,CAAc,YAAd,EAA4BH,cAA5B,E;;;;;;;;;;;;;;;;;AC5LA;;;;AACA;;;;;;;;;;;;IAEM8C,e;;;AACJ,6BAAiE;AAAA,QAArDC,aAAqD,uEAArC,WAAqC;AAAA,QAAxBC,MAAwB,uEAAf,CAAe;AAAA,QAAZC,MAAY,uEAAH,CAAG;;AAAA;;AAAA;;AAG/D,UAAKC,IAAL,GAAYH,aAAZ;AACA,UAAKxB,KAAL,GAAa,CAAb;AACA,UAAK4B,QAAL,GAAgB,CAAhB;AACA,UAAKC,MAAL,GAAc,EAAd;;AAEA,UAAKjF,EAAL,GAAU6E,MAAV;AACA,UAAK5E,EAAL,GAAU6E,MAAV;;AAEA,UAAKI,KAAL,GAAa,SAAb,CAX+D,CAWvC;AAXuC;AAYhE;;;;gCAEWjB,Q,EAAU;AACpB,oIAAkBA,QAAlB;AACA,WAAKjE,EAAL,GAAUmF,KAAKC,KAAL,CAAW,KAAKnB,QAAL,CAAcH,CAAd,GAAkB,uBAAauB,UAA1C,CAAV;AACA,WAAKpF,EAAL,GAAUkF,KAAKC,KAAL,CAAW,KAAKnB,QAAL,CAAcF,CAAd,GAAkB,uBAAasB,UAA1C,CAAV;AACA,UAAG,KAAKrF,EAAL,GAAU,CAAb,EAAgB,KAAKA,EAAL,GAAU,CAAV;AAChB,UAAG,KAAKC,EAAL,GAAU,CAAb,EAAgB,KAAKA,EAAL,GAAU,CAAV;AACjB;;;;;;AACF;;kBAEc0E,e;;;;;;;AC5Bf,+B;;;;;;;;;;;;;;;;ACCA,IAAMW,eAAe;AACnBD,cAAY;AADO,CAArB;;kBAIeC,Y;;;;;;;;;;;;;;;ICJTC,U,GACJ,sBAAc;AAAA;;AACZ,OAAKtB,QAAL,GAAgB;AACdH,OAAG,CADW;AAEdC,OAAG;AAFW,GAAhB;AAID,C;;kBAGYwB,U;;;;;;;;;;;;;;;ACVf;;;;;;;;;;;;IAEMC,M;;;;;;;;;;;gCAEQvB,Q,EAAU;AACpB,WAAKA,QAAL,CAAcH,CAAd,GAAkBG,SAASH,CAA3B;AACA,WAAKG,QAAL,CAAcF,CAAd,GAAkBE,SAASF,CAA3B;AACA,UAAG,KAAKE,QAAL,CAAcH,CAAd,GAAkB,CAArB,EAAwB,KAAKG,QAAL,CAAcH,CAAd,GAAkB,CAAlB;AACxB,UAAG,KAAKG,QAAL,CAAcF,CAAd,GAAkB,CAArB,EAAwB,KAAKE,QAAL,CAAcF,CAAd,GAAkB,CAAlB;AACzB;;;;;;kBAIYyB,M;;;;;;;;;;;;ACbf,IAAMC,eAAe;AACnBrD,OAAK,KADc;AAEnBY,kBAAgB,gBAFG;AAGnBG,QAAM,MAHa;AAInBG,cAAY,aAJO;AAKnBE,eAAa,cALM;AAMnBjB,UAAQ,SANW;AAOnBmB,QAAM;AAPa,CAArB;kBASe+B,Y;;;;;;;;;;;;;;;ACTf;;;;;;;;;;;;IAEMC,S;;;;;;;;;;;4BACItB,O,EAAS;AACf;AACA,aAAO,IAAP;AACD;;;;;;kBAGYsB,S","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5e8ab524c9d1c7643f76","\nfunction Client(info) {\n  this.socket = info.socket;\n  this.token = info.token;\n  this.authenticated = info.authenticated || false;\n  this.ipAddress = this.socket.upgradeReq.headers['x-forwarded-for']\n                    || this.socket.upgradeReq.connection.remoteAddress;\n  this.playerCharacter = info.playerCharacter || null;\n}\n\nmodule.exports = Client;\n\n\n\n// WEBPACK FOOTER //\n// ./classes/server/Client.js","import PlayerCharacter from '../shared/PlayerCharacter';\n\nclass DatabaseManager {\n  getPlayer(playerName) {\n    // Todo: get player information from a database and Object.assign it.\n    return new PlayerCharacter('James');\n  }\n}\n\nconst DbManager = new DatabaseManager();\n\nexport default DbManager;\n\n\n// WEBPACK FOOTER //\n// ./classes/server/DatabaseManager.js","\nconst fs = require('fs');\n\nfunction Level(levelId) {\n  // Initialize defaults\n  this.start = { tx: -1, ty: -1 };\n  this.tileMap = [];\n  this.sprites = [];\n\n  // Load data\n  if (levelId) {\n    this.id = levelId;\n    this.loadFromJSONFile(`./levels/level_${levelId}.json`);\n  } else {\n    throw new Error(\"Didn't provide level ID\");\n  }\n}\n\nLevel.prototype.loadFromJSONFile = function loadFromJSONFile(filename) {\n  const levelData = JSON.parse(fs.readFileSync(filename, 'utf-8'));\n  this.start = levelData.start;\n  this.tileMap = levelData.tileMap;\n  this.sprites = levelData.sprites;\n};\n\nmodule.exports = Level;\n\n\n\n// WEBPACK FOOTER //\n// ./classes/server/Level.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"random-token\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"random-token\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"ws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ws\"\n// module id = 7\n// module chunks = 0","// External Dependencies\nimport express from 'express';\nimport http from 'http';\nimport WebSocket from 'ws';\nimport randomToken from 'random-token';\n\n// Internal Dependencies\nimport Client from './classes/server/Client';\nimport Level from './classes/server/Level';\n\nimport DatabaseManager from './classes/server/DatabaseManager';\n\n// Shared Dependencies\n\n// Application Globals\nconst world = {\n  levels: [],\n  clients: {}\n};\n\n// Constants & Enumerations\nimport MessageTypes from './classes/MessageTypes';\n\n// Helpers & Abstractions\nconst log = console.log; // TODO: log things to a file for production.\n\nconst authenticate = function authenticate(authString) { // TODO: add function name and explain why!\n  // TODO: Faking user authentication. Need the real thing.\n  const [user, passHash] = authString.split(':');\n\n  if (user && passHash && user.toLowerCase() === 'james') {\n    return true;\n  }\n\n  return false;\n};\n\n// Serving front end items (web pages, client scripts, images, etc.)\nconst app = express();\napp.use(express.static('client'));\nhttp.createServer(app).listen(5555, () => log('App started.'));\n\n// Socket Event Handlers\nconst initiateClient = (socket) => {\n  // Add socket to client list.\n  let clientToken = randomToken(16);\n  while (world.clients.clientToken) {\n    clientToken = randomToken(16);\n  }\n  const client = new Client({\n    token: clientToken,\n    socket,\n    playerCharacter: null\n  });\n  world.clients[clientToken] = client;\n\n  // Define socket behaviors\n  socket.on('message', clientMessage.bind(client));\n  // socket.on('close', clientClose);\n  // socket.on('error', clientError);\n\n  socket.on('keyPressed', (info) => {\n    log(info);\n  });\n\n  sendPackage(socket, MessageTypes.Who);\n};\n\nconst sendPackage = function sendPackage(socket, type = null, attributes = {}) {\n  if (socket === null) throw new Error('Socket must be specified.'); // TODO: instanceof what?\n  if (type === null) throw new Error('Package type must be specified.');\n\n  if(type === MessageTypes.MoveTo) console.log(\"Moving... \" + JSON.stringify(attributes));\n  socket.send(JSON.stringify(Object.assign({ type }, attributes)));\n};\n\nconst clientMessage = function clientMessage(incoming = '{}') {\n  // 'this' === the client that generated this message\n\n  const message = JSON.parse(incoming);\n\n  switch (message.type) {\n    case MessageTypes.Who:\n      if (authenticate(message.who)) {\n        this.playerCharacter = DatabaseManager.getPlayer('James');\n        sendPackage(\n          this.socket,\n          MessageTypes.Authentication,\n          { success: true, token: this.token, playerCharacter: JSON.stringify(this.playerCharacter) }\n        );\n      } else {\n        sendPackage(\n          this.socket,\n          MessageTypes.Authentication,\n          { success: false, errorMessage: 'Authentication failed.' }\n        );\n      }\n      break;\n    case MessageTypes.Port: // eslint-disable-line\n      // incoming -> message: { levelId }\n      const level = new Level(message.levelId);\n      const pc = this.playerCharacter;\n      pc.tx = level.start.tx;\n      pc.ty = level.start.ty;\n\n      // TODO: Will need to check whether player is \"allowed\" to port here.\n      //  For example, are they currently near a portal to this area?\n      sendPackage(\n        this.socket,\n        MessageTypes.Port,\n        { success: true, level, playerCharacter: pc }\n      );\n      break;\n    case MessageTypes.KeyPressed:\n      handleKeyPressed(this, message);\n      break;\n    case MessageTypes.KeyReleased:\n      handleKeyReleased(this, message);\n      break;\n    case MessageTypes.Cast:\n      castSpell(this, message);\n      break;\n    default:\n      log('Unhandled socket communcation.');\n      break;\n  }\n};\n\nconst handleKeyPressed = function handleKeyPressed(client, message) {\n  const action = message.action;\n  const pc = client.playerCharacter;\n  const newDirection = { x: 0, y: 0 };\n  switch (action) {\n    case 'LEFT':\n      newDirection.x -=1;\n      //pc.setPosition({ x: pc.position.x - 1, y: pc.position.y });\n      break;\n    case 'RIGHT':\n      newDirection.x +=1;\n      //pc.setPosition({ x: pc.position.x + 1, y: pc.position.y });\n      break;\n    case 'UP':\n      newDirection.y -=1;\n      //pc.setPosition({ x: pc.position.x, y: pc.position.y - 1 });\n      break;\n    case 'DOWN':\n      newDirection.y +=1;\n      //pc.setPosition({ x: pc.position.x, y: pc.position.y + 1 });\n      break;\n    default:\n      break;\n  }\n  // newDirection.x *= pc.walkSpeed / deltaTime;\n  newDirection.x *= 2.5;\n  // newDirection.y *= pc.walkSpeed / deltatime;\n  newDirection.y *= 2.5;\n  pc.setPosition({\n    x: pc.position.x + newDirection.x,\n    y: pc.position.y + newDirection.y\n  });\n  console.log(pc.position);\n  sendPackage(\n    client.socket,\n    MessageTypes.MoveTo,\n    {\n      x: pc.position.x,\n      y: pc.position.y\n    }\n  );\n  console.log(`Handled a ${action} keypress... sort of`);\n};\nconst handleKeyReleased = function handleKeyReleased(client, message) {\n  const action = message.action;\n};\n\nconst castSpell = function castSpell(client, message) {\n  if(client.player.canCast(message.spellId)) {\n    // TODO: Eventually something like this -> client.player.cast(DatabaseManager.getSpell(spellId));\n    const fb = new FireBall();\n  } else {\n\n  }\n}\n\n// Serving the game service.\nconst gameServer = new WebSocket.Server({\n  perMessageDeflate: false,\n  port: 8080,\n});\ngameServer.on('connection', initiateClient);\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","\nimport Character from './Character';\nimport GameSettings from '../GameSettings';\n\nclass PlayerCharacter extends Character {\n  constructor(characterName = 'BoOoOoOob', startX = 1, startY = 1) {\n    super();\n    \n    this.name = characterName;\n    this.level = 1;\n    this.strength = 1;\n    this.health = 50;\n    \n    this.tx = startX;\n    this.ty = startY;\n    \n    this.color = '#3aadd1'; // TODO: Do we want to keep this property?\n  }\n\n  setPosition(position) {\n    super.setPosition(position);\n    this.tx = Math.round(this.position.x / GameSettings.TILE_SCALE);\n    this.ty = Math.round(this.position.y / GameSettings.TILE_SCALE);\n    if(this.tx < 0) this.tx = 0;\n    if(this.ty < 0) this.ty = 0;\n  }\n};\n\nexport default PlayerCharacter;\n\n\n// WEBPACK FOOTER //\n// ./classes/shared/PlayerCharacter.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 11\n// module chunks = 0","\nconst GameSettings = {\n  TILE_SCALE: 32\n}\n\nexport default GameSettings;\n\n\n// WEBPACK FOOTER //\n// ./classes/GameSettings.js","\nclass GameObject {\n  constructor() {\n    this.position = {\n      x: 0,\n      y: 0\n    }\n  }\n}\n\nexport default GameObject;\n\n\n// WEBPACK FOOTER //\n// ./classes/shared/GameObject.js","import GameObject from './GameObject'\n\nclass Sprite extends GameObject {\n  \n  setPosition(position) {\n    this.position.x = position.x;\n    this.position.y = position.y;\n    if(this.position.x < 0) this.position.x = 0;\n    if(this.position.y < 0) this.position.y = 0;\n  }\n\n}\n\nexport default Sprite;\n\n\n// WEBPACK FOOTER //\n// ./classes/shared/Sprite.js","const MessageTypes = {\n  Who: 'WHO',\n  Authentication: 'AUTHENTICATION',\n  Port: 'PORT',\n  KeyPressed: 'KEY_PRESSED',\n  KeyReleased: 'KEY_RELEASED',\n  MoveTo: 'MOVE_TO',\n  Cast: 'CAST'\n};\nexport default MessageTypes;\n\n\n// WEBPACK FOOTER //\n// ./classes/MessageTypes.js","import Sprite from './Sprite';\n\nclass Character extends Sprite {\n  canCast(spellId) {\n    // TODO: Check if the character has the spell in their spellbook and if it's not on cooldown.\n    return true;\n  }\n}\n\nexport default Character;\n\n\n// WEBPACK FOOTER //\n// ./classes/shared/Character.js"],"sourceRoot":""}